"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5187],{17094:(e,t,r)=>{r.d(t,{Hy:()=>P});var n=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,u=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&u(e,r,t[r]);if(i)for(var r of i(t))a.call(t,r)&&u(e,r,t[r]);return e},p=(e,t)=>o(e,s(t)),d=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},f=async(e,t)=>{var r,n,o,s,i,l;let a=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:a,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));a=n.options||a,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(o=c.hooks)?void 0:o.onResponse),u.onSuccess.push(null==(s=c.hooks)?void 0:s.onSuccess),u.onError.push(null==(i=c.hooks)?void 0:i.onError),u.onRetry.push(null==(l=c.hooks)?void 0:l.onRetry)}return{url:e,options:a,hooks:u}},h=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},y=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},v=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let n=r(e.auth.username),o=r(e.auth.password);if(!n||!o)return t;t.authorization=`Basic ${btoa(`${n}:${o}`)}`}else if("Custom"===e.auth.type){let n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},m=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function g(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function b(e){try{return JSON.parse(e)}catch(t){return e}}function w(e){return"function"==typeof e}async function R(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await v(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=g(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var T=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function O(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new T(r.issues);return r.value}var S=["get","post","put","patch","delete"],E=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,r){var n,o,s,i;let l=(null==(o=null==(n=e.plugins)?void 0:n.find(e=>{var r;return null!=(r=e.schema)&&!!r.config&&(t.startsWith(e.schema.config.baseURL||"")||t.startsWith(e.schema.config.prefix||""))}))?void 0:o.schema)||e.schema;if(l){let e=t;(null==(s=l.config)?void 0:s.prefix)&&e.startsWith(l.config.prefix)&&(e=e.replace(l.config.prefix,""),l.config.baseURL&&(t=t.replace(l.config.prefix,l.config.baseURL))),(null==(i=l.config)?void 0:i.baseURL)&&e.startsWith(l.config.baseURL)&&(e=e.replace(l.config.baseURL,""));let n=l.schema[e];if(n){let e=p(c({},r),{method:n.method,output:n.output});return(null==r?void 0:r.disableValidation)||(e=p(c({},e),{body:n.input?await O(n.input,null==r?void 0:r.body):null==r?void 0:r.body,params:n.params?await O(n.params,null==r?void 0:r.params):null==r?void 0:r.params,query:n.query?await O(n.query,null==r?void 0:r.query):null==r?void 0:r.query})),{url:t,options:e}}}return{url:t,options:r}}}),P=e=>async function(t,r){let n=p(c(c({},e),r),{plugins:[...(null==e?void 0:e.plugins)||[],E(e||{})]});if(null==e?void 0:e.catchAllError)try{return await A(t,n)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await A(t,n)},A=async(e,t)=>{var r,n,o,s,i,l,a,u;let{hooks:v,url:T,options:E}=await f(e,t),P=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&w(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&w(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(E),j=new AbortController,U=null!=(r=E.signal)?r:j.signal,I=function(e,t){let{baseURL:r,params:n,query:o}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];S.includes(t)&&(e=e.replace(`@${t}/`,"/"))}s.endsWith("/")||(s+="/");let[i,l]=e.replace(s,"").split("?"),a=new URLSearchParams(l);for(let[e,t]of Object.entries(o||{}))null!=t&&a.set(e,String(t));if(n)if(Array.isArray(n))for(let[e,t]of i.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];i=i.replace(t,r)}else for(let[e,t]of Object.entries(n))i=i.replace(`:${e}`,String(t));(i=i.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(i=i.slice(1));let u=a.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",s.startsWith("http"))?new URL(`${i}${u}`,s):`${s}${i}${u}`}(T,E),_=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(g(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return e.body}(E),x=await R(E),$=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return S.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(T,E),L=p(c({},E),{url:I,headers:x,body:_,method:$,signal:U});for(let e of v.onRequest)if(e){let t=await e(L);t instanceof Object&&(L=t)}("pipeTo"in L&&"function"==typeof L.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in L)&&(L.duplex="half");let{clearTimeout:N}=function(e,t){let r;return!(null==e?void 0:e.signal)&&(null==e?void 0:e.timeout)&&(r=setTimeout(()=>null==t?void 0:t.abort(),null==e?void 0:e.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}(E,j),k=await P(L.url,L);N();let C={response:k,request:L};for(let e of v.onResponse)if(e){let r=await e(p(c({},C),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?k.clone():k}));r instanceof Response?k=r:r instanceof Object&&(k=r.response)}if(k.ok){if("HEAD"===L.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return m.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(k),r={data:"",response:k,request:L};if("json"===e||"text"===e){let e=await k.text(),t=null!=(s=L.jsonParser)?s:b;r.data=await t(e)}else r.data=await k[e]();for(let e of((null==L?void 0:L.output)&&L.output&&!L.disableValidation&&(r.data=await O(L.output,r.data)),v.onSuccess))e&&await e(p(c({},r),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?k.clone():k}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let q=null!=(l=null==t?void 0:t.jsonParser)?l:b,B=await k.text(),W=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(B),D=W?await q(B):null,F={response:k,responseText:B,request:L,error:p(c({},D),{status:k.status,statusText:k.statusText})};for(let e of v.onError)e&&await e(p(c({},F),{response:(null==(a=null==t?void 0:t.hookOptions)?void 0:a.cloneResponse)?k.clone():k}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new h({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new h(e);case"exponential":return new y(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,k)){for(let e of v.onRetry)e&&await e(C);let o=r.getDelay(n);return await new Promise(e=>setTimeout(e,o)),await A(e,p(c({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new d(k.status,k.statusText,W?D:B);return{data:null,error:p(c({},D),{status:k.status,statusText:k.statusText})}}},34342:(e,t,r)=>{r.d(t,{MB:()=>R});var n=r(17094),o=r(47323),s=r(65468);function i(e,t="/api/auth"){return!function(e){try{let t=new URL(e);return"/"!==t.pathname}catch(t){throw new s.B(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e)?(t=t.startsWith("/")?t:`/${t}`,`${e.replace(/\/+$/,"")}${t}`):e}let l=[],a=0,u=0,c=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=a+4;t<l.length;)l[t]===e?l.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){u++;let o=!l.length;for(let o of t)l.push(o,r.value,e,n);if(o){for(a=0;a<l.length;a+=4)l[a](l[a+1],l[a+2],l[a+3]);l.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},p=(e,t,r,n)=>(e.events=e.events||{},e.events[r+10]||(e.events[r+10]=n(t=>{e.events[r].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[r]=e.events[r]||[],e.events[r].push(t),()=>{let n=e.events[r],o=n.indexOf(t);n.splice(o,1),n.length||(delete e.events[r],e.events[r+10](),delete e.events[r+10])}),d=(e,t)=>p(e,r=>{let n=t(r);n&&e.events[6].push(n)},5,t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}}),f=(e,t,r,n)=>{let o=c({data:null,error:null,isPending:!0,isRefetching:!1,refetch:()=>s()}),s=()=>{let e="function"==typeof n?n({data:o.get().data,error:o.get().error,isPending:o.get().isPending}):n;return r(t,{...e,async onSuccess(t){"undefined"!=typeof window&&o.set({data:t.data,error:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await e?.onSuccess?.(t)},async onError(t){let{request:r}=t,n="number"==typeof r.retry?r.retry:r.retry?.attempts,s=r.retryAttempt||0;n&&s<n||(o.set({error:t.error,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await e?.onError?.(t))},async onRequest(t){let r=o.get();o.set({isPending:null===r.data,data:r.data,error:null,isRefetching:!0,refetch:o.value.refetch}),await e?.onRequest?.(t)}})};e=Array.isArray(e)?e:[e];let i=!1;for(let t of e)t.subscribe(()=>{i?s():d(o,()=>(s(),i=!0,()=>{o.off(),t.off()}))});return o},h={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},y=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,v={true:!0,false:!1,null:null,undefined:void 0,nan:Number.NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},m=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,g={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},b=e=>{let t="credentials"in Request.prototype,r=function(e,t,r){if(e)return i(e,t);let n=o.e.BETTER_AUTH_URL||o.e.NEXT_PUBLIC_BETTER_AUTH_URL||o.e.PUBLIC_BETTER_AUTH_URL||o.e.NUXT_PUBLIC_BETTER_AUTH_URL||o.e.NUXT_PUBLIC_AUTH_URL||("/"!==o.e.BASE_URL?o.e.BASE_URL:void 0);if(n)return i(n,t);let l=void 0,a=void 0;if(l&&a)return i(`${a}://${l}`,t);if(r){let e=function(e){try{return new URL(e).origin}catch(e){return null}}(r.url);if(!e)throw new s.B("Could not get origin from request. Please provide a valid base URL.");return i(e,t)}if("undefined"!=typeof window&&window.location)return i(window.location.origin,t)}(e?.baseURL,e?.basePath),l=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],a=(0,n.Hy)({baseURL:r,...t?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:o,parseDates:s=!0}=t;if("string"!=typeof e)return e;let i=e.trim();if('"'===i[0]&&i.endsWith('"')&&!i.slice(1,-1).includes('"'))return i.slice(1,-1);let l=i.toLowerCase();if(l.length<=9&&l in v)return v[l];if(!y.test(i)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(h).some(([e,t])=>{let r=t.test(i);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(i,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(s&&"string"==typeof t){let e=function(e){let t=m.exec(e);if(!t)return null;let[,r,n,o,s,i,l,a,u,c,p]=t,d=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(o,10),parseInt(s,10),parseInt(i,10),parseInt(l,10),a?parseInt(a.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(p,10))*("+"===u?-1:1);d.setUTCMinutes(d.getUTCMinutes()+e)}return d instanceof Date&&!isNaN(d.getTime())?d:null}(t);if(e)return e}return o?o(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:async(e,t)=>{try{return await fetch(e,t)}catch(e){return Response.error()}},...e?.fetchOptions,plugins:e?.disableDefaultFetchPlugins?[...e?.fetchOptions?.plugins||[],...l]:[g,...e?.fetchOptions?.plugins||[],...l]}),{$sessionSignal:u,session:p}=function(e){let t=c(!1);return{session:f(t,"/get-session",e,{method:"GET"}),$sessionSignal:t}}(a),d=e?.plugins||[],b={},w={$sessionSignal:u,session:p},R={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},T=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||e.startsWith("/sign-in")||e.startsWith("/sign-up")||"/delete-user"===e||"/verify-email"===e}];for(let e of d)e.getAtoms&&Object.assign(w,e.getAtoms?.(a)),e.pathMethods&&Object.assign(R,e.pathMethods),e.atomListeners&&T.push(...e.atomListeners);let O={notify:e=>{w[e].set(!w[e].get())},listen:(e,t)=>{w[e].subscribe(t)},atoms:w};for(let t of d)t.getActions&&Object.assign(b,t.getActions?.(a,O,e));return{pluginsActions:b,pluginsAtoms:w,pluginPathMethods:R,atomListeners:T,$fetch:a,$store:O}};var w=r(62847);function R(e){var t,r;let{pluginPathMethods:n,pluginsActions:o,pluginsAtoms:s,$fetch:i,$store:l,atomListeners:a}=b(e),u={};for(let[e,t]of Object.entries(s)){u[`use${(r=e).charAt(0).toUpperCase()+r.slice(1)}`]=()=>(function(e,t={}){let r=(0,w.useRef)(e.get()),{keys:n,deps:o=[e,n]}=t,s=(0,w.useCallback)(t=>{let o=e=>{r.current!==e&&(r.current=e,t())};return(o(e.value),n?.length)?function(e,t,r){let n=new Set(t).add(void 0);return e.listen((e,t,o)=>{n.has(o)&&r(e,t,o)})}(e,n,o):e.listen(o)},o),i=()=>r.current;return(0,w.useSyncExternalStore)(s,i,i)})(t)}return t={...o,...u,$fetch:i,$store:l},function e(r=[]){return new Proxy(function(){},{get(n,o){let s=[...r,o],i=t;for(let e of s)if(i&&"object"==typeof i&&e in i)i=i[e];else{i=void 0;break}return"function"==typeof i?i:e(s)},apply:async(e,t,o)=>{let l="/"+r.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=o[0]||{},c=o[1]||{},{query:p,fetchOptions:d,...f}=u,h={...c,...d},y=function(e,t,r){let n=t[e],{fetchOptions:o,query:s,...i}=r||{};return n||(o?.method?o.method:i&&Object.keys(i).length>0?"POST":"GET")}(l,n,u);return await i(l,{...h,body:"GET"===y?void 0:{...f,...h?.body||{}},query:p||h?.query,method:y,async onSuccess(e){await h?.onSuccess?.(e);let t=a?.find(e=>e.matcher(l));if(!t)return;let r=s[t.signal];if(!r)return;let n=r.get();setTimeout(()=>{r.set(!n)},10)}})}})}()}},47323:(e,t,r)=>{r.d(t,{e:()=>l});var n,o=r(81247);let s=Object.create(null),i=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?s:globalThis),l=new Proxy(s,{get:(e,t)=>i()[t]??s[t],has:(e,t)=>t in i()||t in s,set:(e,t,r)=>(i(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=i(!0);return delete r[t],!0},ownKeys:()=>Object.keys(i(!0))});"test"===(void 0!==o&&o.env&&"production"||"")||(n=l.TEST)},65468:(e,t,r)=>{r.d(t,{B:()=>n});class n extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}}},98571:(e,t,r)=>{r.d(t,{px:()=>d,N$:()=>f}),r(17094),r(47323);var n=r(65468);function o(e){return{newRole:e=>{var t;return{authorize(e,r="AND"){let o=!1;for(let[s,i]of Object.entries(e)){let e=t[s];if(!e)return{success:!1,error:`You are not allowed to access resource: ${s}`};if(Array.isArray(i))o=i.every(t=>e.includes(t));else if("object"==typeof i)o="OR"===i.connector?i.actions.some(t=>e.includes(t)):i.actions.every(t=>e.includes(t));else throw new n.B("Invalid access control request");if(o&&"OR"===r)return{success:o};if(!o&&"AND"===r)return{success:!1,error:`unauthorized to access resource "${s}"`}}return o?{success:o}:{success:!1,error:"Not authorized"}},statements:t=e}},statements:e}}let s=o({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"]});s.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"]}),s.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"]}),s.newRole({organization:[],member:[],invitation:[],team:[]});class i{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}new i;let l=o({user:["create","list","set-role","ban","impersonate","delete","set-password"],session:["list","revoke","delete"]}),a=l.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password"],session:["list","revoke","delete"]}),u=l.newRole({user:[],session:[]}),c={admin:a,user:u},p=e=>{if(e.userId&&e.options?.adminUserIds?.includes(e.userId))return!0;if(!e.permissions&&!e.permission)return!1;let t=(e.role||e.options?.defaultRole||"user").split(","),r=e.options?.roles||c;for(let n of t){let t=r[n],o=t?.authorize(e.permission??e.permissions);if(o?.success)return!0}return!1},d=e=>{let t={admin:a,user:u,...e?.roles};return{id:"admin-client",$InferServerPlugin:{},getActions:r=>({admin:{checkRolePermission:r=>p({role:r.role,options:{ac:e?.ac,roles:t},permissions:r.permissions??r.permission})}}),pathMethods:{"/admin/list-users":"GET","/admin/stop-impersonating":"POST"}}},f=()=>({id:"email-otp",$InferServerPlugin:{}})}}]);
(()=>{var e={};e.id=6375,e.ids=[6375],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},35979:()=>{},36639:(e,t,r)=>{"use strict";e.exports=r(44870)},37086:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var s=r(96330);let i=global.prisma||new s.PrismaClient},38605:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var s=r(99507),i=r(94149);let n=process.env.SKIP_ENV_VALIDATION?"sk_test_dummy_key_for_build":i._.STRIPE_SECRET_KEY,o=new s.A(n,{apiVersion:"2025-05-28.basil",typescript:!0})},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},86912:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>c,serverHooks:()=>S,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{POST:()=>E});var i=r(36639),n=r(99880),o=r(77991),a=r(37086),u=r(94149),p=r(38605),_=r(43831);async function E(e){let t,r=await e.text(),s=(await (0,_.headers)()).get("Stripe-Signature");try{t=p._.webhooks.constructEvent(r,s,u._.STRIPE_WEBHOOK_SECRET)}catch{return new Response("Webhook error",{status:400})}let i=t.data.object;if("checkout.session.completed"===t.type){let e=i.metadata?.courseId,t=i.customer;if(!e)throw Error("Course id not found...");let r=await a.z.user.findUnique({where:{stripeCustomerId:t}});if(!r)throw Error("User not found...");await a.z.enrollment.update({where:{id:i.metadata?.enrollmentId},data:{userId:r.id,courseId:e,amount:i.amount_total,status:"Active"}})}return new Response(null,{status:200})}let c=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/webhook/stripe/route",pathname:"/api/webhook/stripe",filename:"route",bundlePath:"app/api/webhook/stripe/route"},resolvedPagePath:"/Users/sanket/Documents/LMS-Organomed copy/app/api/webhook/stripe/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:S}=c;function m(){return(0,o.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}},94149:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});var s=r(97191),i=r(79082);let n=(0,s.w)({server:{DATABASE_URL:i.z.string().url(),BETTER_AUTH_SECRET:i.z.string().min(1),BETTER_AUTH_URL:i.z.string().url(),AUTH_GITHUB_CLIENT_ID:i.z.string().min(1),AUTH_GITHUB_SECRET:i.z.string().min(1),EMAIL_SERVICE:i.z.string().optional(),EMAIL_HOST:i.z.string().optional(),EMAIL_PORT:i.z.string().optional(),EMAIL_SECURE:i.z.string().optional(),EMAIL_USER:i.z.string().optional(),EMAIL_PASS:i.z.string().optional(),EMAIL_FROM:i.z.string().optional(),AWS_ACCESS_KEY_ID:i.z.string().min(1),AWS_SECRET_ACCESS_KEY:i.z.string().min(1),AWS_ENDPOINT_URL_S3:i.z.string().min(1),AWS_ENDPOINT_URL_IAM:i.z.string().min(1),AWS_REGION:i.z.string().min(1),STRIPE_SECRET_KEY:i.z.string().min(1),STRIPE_WEBHOOK_SECRET:i.z.string().min(1)},skipValidation:!!process.env.SKIP_ENV_VALIDATION,client:{NEXT_PUBLIC_S3_BUCKET_NAME_IMAGES:i.z.string().min(1)},experimental__runtimeEnv:{NEXT_PUBLIC_S3_BUCKET_NAME_IMAGES:"placeholder-bucket"}})},94735:e=>{"use strict";e.exports=require("events")},95651:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7991,2692,3831,5715],()=>r(86912));module.exports=s})();